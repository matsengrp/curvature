---
title: "Ricci"
runtime: shiny
output: html_document
---

```{r, echo=FALSE}

library(ggvis)

d <- read.table("../../ricci5.mat", stringsAsFactors=FALSE)
colnames(d) <- c("t1_idx", "t2_idx", "t1_nwk", "t2_nwk", "mult", "dist", "kappa_str")
d <- subset(d, kappa_str != "-")
d$kappa <- sapply(d$kappa_str, function(s) eval(parse(text=s)))
d$info= paste(d$t1_nwk, d$t2_nwk, paste("kappa:", d$kappa_str), sep="<br />")

d %>%
  ggvis(x = ~kappa, y = ~dist) %>%
  layer_points(size = ~mult, fill = ~t1_nwk, stroke = ~t2_idx) %>%
  # A dummy layer so that we can use text in the tooltip.
  layer_text(text := ~info, fontSize := 0) %>%
  add_axis("x", grid = FALSE) %>%
  add_axis("y", grid = FALSE, values = 1:3) %>%
  add_legend(c("fill"), properties=legend_props(legend=list(y=0))) %>%
  add_legend(c("stroke"), properties=legend_props(legend=list(y=70))) %>%
  add_legend(c("size"), properties=legend_props(legend=list(y=120))) %>%
  set_options(width=500, height = 150) %>%
  add_tooltip(function(df) df$info)
```